<?xml version="1.0" standalone="no"?>

<kickstart>

  <description>

  Secure Sockets Layer for frontend nodes.

  </description>

        <copyright>
        Copyright (c) 2000 - 2008 The Regents of the University of California.
        All rights reserved. Rocks(r) v5.0 www.rocksclusters.org
        </copyright>

  <changelog>
  $Log: ssl-server.xml,v $
  Revision 1.5  2008/03/11 19:07:33  bruno
  ssl certificates moved in RHEL 5

  Revision 1.4  2008/03/06 23:41:30  mjk
  copyright storm on

  Revision 1.3  2007/08/08 16:00:58  mjk
  cert is good for five years (and we get less email)

  Revision 1.2  2007/06/23 04:03:18  mjk
  mars hill copyright

  Revision 1.1  2005/03/01 00:22:26  mjk
  moved to base roll

  Revision 1.2  2005/02/15 22:58:52  mjk
  dtd is gone

  Revision 1.1  2004/08/10 19:05:42  fds
  Moved to new security graph hierarchy.

  </changelog>

<post>

<!-- Make a Certificate for Mod_SSL -->
(
cd /etc/pki/tls ; \
/usr/bin/openssl req -new -nodes -config /etc/security/ca/ca.cfg \
	-keyout private/localhost.key \
	-subj "\
/C=<var name="Info_CertificateCountry"/>/\
ST=<var name="Info_CertificateState"/>/\
L=<var name="Info_CertificateLocality"/>/\
O=<var name="Info_CertificateOrganization"/>/\
OU=<var name="Info_ClusterName"/>/\
CN=<var name="Kickstart_PublicHostname"/>" \
	&gt; certs/localhost.csr ; \
chmod 0400 private/localhost.key
)

<!-- Sign the Request with our CA-->
(
cd /etc/security/ca; \
/usr/bin/openssl x509 -req -days 2000 \
	-CA ca.crt -CAkey ca.key -CAserial ca.serial \
	&lt; /etc/pki/tls/certs/localhost.csr \
	&gt; /etc/pki/tls/certs/localhost.crt ; \
chmod 0444 /etc/pki/tls/certs/localhost.crt
)

</post>

</kickstart> 

